<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">

  <!-- Custom fonts for this template-->
  <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

  <!-- Custom styles for this template-->
  <link href="css/sb-admin-2.min.css" rel="stylesheet">
  <title>MHDP Full Calendar</title>

  <script>
    var lastname = '<%= LastName%>';

    let date = new Date();

    const renderCalender = () => {
      const viewYear = date.getFullYear();
      const viewMonth = date.getMonth();

      document.querySelector('.year-month').textContent = `${viewYear}년 ${viewMonth + 1}월`;

      const prevLast = new Date(viewYear, viewMonth, 0);
      const thisLast = new Date(viewYear, viewMonth + 1, 0);

      const PLDate = prevLast.getDate();
      const PLDay = prevLast.getDay();

      const TLDate = thisLast.getDate();
      const TLDay = thisLast.getDay();

      const prevDates = [];
      const thisDates = [...Array(TLDate + 1).keys()].slice(1);
      const nextDates = [];

      if (PLDay !== 6) {
        for (let i = 0; i < PLDay + 1; i++) {
          prevDates.unshift(PLDate - i);
        }
      }

      for (let i = 1; i < 7 - TLDay; i++) {
        nextDates.push(i);
      }

      const dates = prevDates.concat(thisDates, nextDates);
      const firstDateIndex = dates.indexOf(1);
      const lastDateIndex = dates.lastIndexOf(TLDate);

      dates.forEach((date, i) => {
        const condition = i >= firstDateIndex && i < lastDateIndex + 1
                          ? 'this'
                          : 'other';
        dates[i] = `<div class="date"><span class=${condition}>${date}</span>
                                      <span id=test></span></div>`;
      });

      document.querySelector('.dates').innerHTML = dates.join('');

      const today = new Date();
      if (viewMonth === today.getMonth() && viewYear === today.getFullYear()) {
        for (let date of document.querySelectorAll('.this')) {
          if (+date.innerText === today.getDate()) {
            date.classList.add('today');
            break;
          }
        }
      }
    };

    const prevMonth = () => {
      date.setMonth(date.getMonth() - 1);
      renderCalender();
    };

    const nextMonth = () => {
      date.setMonth(date.getMonth() + 1);
      renderCalender();
    };

    const goToday = () => {
      date = new Date();
      renderCalender();
    };

    window.onload = function() {
      renderCalender();
    }
  </script>
</head>
<body>
  <div class="calendar">
    <div class="title">
      <h1 class="titleh"><%= LastName%></h1>
      <hr>
    </div>
    <div class="header">
      <div class="year-month"></div>
      <div class="nav">
        <button class="nav-btn go-prev" onclick="prevMonth()">&lt;</button>
        <button class="nav-btn go-today" onclick="goToday()">Today</button>
        <button class="nav-btn go-next" onclick="nextMonth()">&gt;</button>
      </div>
    </div>
    <div class="main">
      <div class="days">
        <div class="day">일</div>
        <div class="day">월</div>
        <div class="day">화</div>
        <div class="day">수</div>
        <div class="day">목</div>
        <div class="day">금</div>
        <div class="day">토</div>
      </div>
      <div class="dates" style="margin-bottom: 50px;"></div>
    </div>
    <form class="user" action="/login" method="POST">
      <div class="form-group row">
        <div class="col-sm-6">
          <input type="text" class="form-control form-control-user" name="LastName" placeholder="이름">
        </div>
      </div>
      <div class="form-group">
        <input type="text" class="form-control form-control-user" name="nickname" placeholder="사용자닉네임">
      </div>
      <div class="form-group">
        <input type="email" class="form-control form-control-user" name="Id" placeholder="이메일을 입력하세요! ">
      </div>
      <div class="form-group row">
        <div class="col-sm-6 mb-3 mb-sm-0">
          <input type="password" class="form-control form-control-user" name="Password" placeholder="비밀번호를 입력하세요!">
        </div>
        <div class="col-sm-6">
          <input type="password" class="form-control form-control-user" name="RepeatPassword" placeholder="비밀번호 확인이니 다시 입력해주세요!">
        </div>
      </div>
      <button type="submit" class="btn btn-primary btn-user btn-block">
        회원가입
      </button>
    </form>
  </div>
  <div>
    
  </div>
  <!-- <script src="js/index.js"></script> -->
</body>
</html>